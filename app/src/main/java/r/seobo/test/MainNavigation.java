package r.seobo.test;

import android.app.Activity;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.TextView;

import java.io.Serializable;

public class MainNavigation extends Activity implements Serializable{
    int pSize = 41;
    int [] current_path = new int[41];
    int current_index = 0;
    int current_x = 0;
    int current_y = 0;
    int current_vertex = -1;
    int current_destination = -1;

    int[][] graph = new int[][]{
            {0, 600, 1099, 1798, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 300, 2795, -1, -1, 2097, -1, -1, -1},
            {600, 0, 500, 1199, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 898, 2196, -1, -1, 1498, -1, -1, -1},
            {1099, 500, 0, 700, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1397, 1697, -1, -1, 999, -1, -1, -1},
            {1798, 1199, 700, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2096, 998, -1, -1, 300, -1, -1, -1},
            {-1, -1, -1, -1, 0, 300, 499, 898, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 400, 1098, -1, -1},
            {-1, -1, -1, -1, 300, 0, 200, 599, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 699, 799, -1, -1},
            {-1, -1, -1, -1, 499, 200, 0, 400, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 998, 600, -1, -1},
            {-1, -1, -1, -1, 898, 599, 400, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1297, 600, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 500, -1, 900, -1, 300, -1, -1, -1, 100, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 300, 699, 998, 1596, -1, -1, 599, 400, 100, 300, 699, 998, 1397, 1596, 2195, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2293, 897, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 300, 0, 400, 699, 1297, -1, -1, 898, 699, 300, 100, 400, 699, 1098, 1297, 1896, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1994, 1196, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 699, 400, 0, 300, 898, -1, -1, 1297, 1098, 699, 400, 100, 300, 699, 898, 1497, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1595, 1595, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 998, 699, 300, 0, 599, -1, -1, 1596, 1397, 998, 699, 300, 100, 400, 599, 1198, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1296, 1894, -1, -1, -1, -1,},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 1596, 1297, 898, 599, 0, 600, -1, 2194, 1995, 1596, 1297, 898, 599, 200, 100, 600, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 698, 2493, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 600, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 400, -1, -1, -1, 500, -1, -1, -1, -1, 200, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 100, -1, -1, -1, 400},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 599, 898, 1297, 1596, 2194, -1, -1, 0, 200, 599, 898, 1297, 1596, 1995, 2194, 2793, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2891, 300, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 400, 699, 1098, 1397, 1995, -1, -1, 200, 0, 400, 699, 1098, 1397, 1796, 1995, 2594, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2692, 498, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 100, 300, 699, 998, 1596, -1, -1, 599, 400, 0, 300, 699, 998, 1397, 1596, 2195, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2293, 897, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 300, 100, 400, 600, 1297, -1, -1, 898, 699, 300, 0, 400, 699, 1098, 1297, 1896, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1994, 1196, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 699, 400, 100, 300, 898, -1, -1, 1297, 1098, 699, 400, 0, 300, 699, 898, 1497, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1595, 1595, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 998, 699, 300, 100, 599, -1, -1, 1596, 1397, 998, 699, 300, 0, 400, 599, 1198, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1296, 1894, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 1497, 1198, 699, 400, 200, -1, -1, 1995, 1796, 1397, 1098, 699, 400, 0, 200, 799, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 897, 2293, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 1596, 1297, 898, 599, 100, -1, -1, 2194, 1995, 1596, 1297, 898, 599, 200, 0, 600, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 698, 2492, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 2195, 1896, 1497, 1198, 600, -1, -1, 2793, 2594, 2195, 1896, 1497, 1198, 799, 600, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 100, 3091, -1, -1, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 200, -1, -1, -1, -1, -1, -1, -1, -1, 200, -1, -1, -1, 400, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 200, 0, -1, -1, -1, -1, -1, -1, -1, -1, 200, -1, -1, -1, 200, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 300, -1, -1, 899, -1, 899, -1, -1, -1, -1, -1, -1, 699},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 300, 0, -1, -1, 600, -1, 600, -1, -1, -1, -1, -1, -1, 400},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, 799, -1, 100, -1, -1, -1, -1, -1, -1, 700},
            {-1, -1, -1, -1, -1, -1, -1, -1, 500, -1, -1, -1, -1, -1, 400, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, 799, -1, 400, -1, -1, -1, 500, 400, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 899, 600, 799, -1, 0, -1, 800, -1, -1, -1, -1, -1, -1, 300},
            {-1, -1, -1, -1, -1, -1, -1, -1, 900, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 799, -1, 0, -1, 1000, -1, -1, -1, 800, -1, -1},
            {300, 898, 1387, 2096, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 899, 600, 100, -1, 800, -1, 0, 3090, -1, -1, 2390, -1, -1, 700},
            {2795, 2196, 1697, 998, -1, -1, -1, -1, 300, -1, -1, -1, -1, -1, 500, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 400, -1, 1000, 3090, 0, -1, -1, 690, 400, 600, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 2293, 1994, 1595, 1296, 698, -1, -1, 2891, 2692, 2293, 1994, 1595, 1296, 897, 698, 100, 200, 200, -1, -1, -1, -1, -1, -1, -1, -1, 0, 3190, -1, -1, 400, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, 897, 1196, 1595, 1894, 2493, -1, 100, 300, 498, 897, 1196, 1595, 1894, 2293, 2492, 3091, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 3190, 0, -1, -1, -1, 400},
            {2097, 1498, 999, 300, 400, 699, 998, 1297, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 2390, 690, -1, -1, 0, -1, -1, -1},
            {-1, -1, -1, -1, 1098, 799, 600, 600, 100, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 500, -1, 800, -1, 400, -1, -1, -1, 0, -1, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 200, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 400, 200, -1, -1, -1, 400, -1, -1, -1, 600, 400, -1, -1, -1, 0, -1},
            {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 400, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 699, 400, 700, -1, 300, -1, 700, -1, -1, 400, -1, -1, -1, 0}


    };




    public int shortestPathValue(int start, int end) {
        if (start > (pSize-1) || end > (pSize-1) || start < 0 || end < 0)
            return 0;

        int[] hasVisited = new int[pSize];
        int[] shortestPaths = new int[pSize];
        for (int i = 0; i < pSize; i++) {
            hasVisited[i] = 0;
            shortestPaths[i] = -1;
        }
        hasVisited[start] = 1;
        shortestPaths[start] = 0;
        for (int i = 0; i < pSize; i++) {
            if (graph[start][i] != -1) {
                shortestPaths[i] = graph[start][i];
            }
        }
        while (hasVisited[end] != 1) {
            int min = -1;
            int next = -1;
            for (int i = 0; i < pSize; i++) {
                if (hasVisited[i] == 1)
                    continue;
                if (min == -1) {
                    min = shortestPaths[i];
                    next = i;
                    continue;
                }
                if (shortestPaths[i] != -1) {
                    if (shortestPaths[i] < min) {
                        min = shortestPaths[i];
                        next = i;
                    }
                }
            }
            hasVisited[next] = 1;
            for (int i = 0; i < pSize; i++) {
                if (hasVisited[i] == 1)
                    continue;
                if (graph[next][i] != -1) {
                    if (shortestPaths[i] == -1 || shortestPaths[i] > (graph[next][i] + shortestPaths[next])) {
                        shortestPaths[i] = (graph[next][i] + shortestPaths[next]);
                    }
                }
            }

        }
        return shortestPaths[end];
    }

    public void setCurrentPath(int start, int end) {
        if(start > (pSize-1) || end > (pSize-1) || start < 0 || end < 0)
            return;
        current_vertex = start;
        current_index = 0;
        current_destination = end;
        int[] hasVisited = new int[pSize];
        int[] shortestPaths = new int[pSize];
        for(int i = 0; i<pSize; i++) {
            hasVisited[i] = 0;
            shortestPaths[i] = -1;
        }
        hasVisited[start] = 1;
        shortestPaths[start] = 0;
        for(int i = 0; i < pSize; i++) {
            if(graph[start][i] != -1) {
                shortestPaths[i] = graph[start][i];
            }
        }
        while(hasVisited[end] != 1)
        {
            int min = -1;
            int next = -1;
            for(int i = 0; i < pSize; i++) {
                if(hasVisited[i] == 1)
                    continue;
                if(min == -1) {
                    min = shortestPaths[i];
                    next = i;
                    continue;
                }
                if(shortestPaths[i] != -1) {
                    if (shortestPaths[i] < min) {
                        min = shortestPaths[i];
                        next = i;
                    }
                }
            }
            hasVisited[next] = 1;
            for(int i = 0; i < pSize; i++) {
                if(hasVisited[i] == 1)
                    continue;
                if(graph[next][i] != -1) {
                    if(shortestPaths[i] == -1 || shortestPaths[i] > (graph[next][i] + shortestPaths[next])){
                        shortestPaths[i] = (graph[next][i] + shortestPaths[next]);
                    }
                }
            }

        }
        int [] revPath = new int [pSize];
        for(int i = 0; i < pSize; i++) {
            revPath[i] = -1;
        }
        int j = 0;
        int current = end;
        while(true){
            int min = -1;
            int next = -1;
            for(int i = 0; i < pSize; i++) {
                if(hasVisited[i] != 1)
                    continue;
                if(graph[i][current] != -1 && graph[i][current] != 0) {
                    if(min == -1) {
                        min = shortestPaths[i] + graph[i][current];
                        next = i;
                        continue;
                    }
                    if ((shortestPaths[i] + graph[i][current]) < min) {
                        min = shortestPaths[i] + graph[i][current];
                        next = i;
                    }
                }
            }
            revPath[j] = current;
            current = next;
            j++;
            if(current == start) {
                revPath[j] = start;
                break;
            }
        }
        int i = 0;
        while(j >= 0) {
            current_path[i] = revPath[j];
            i++;
            j--;
        }
        if(i < pSize-1)
            current_path[i] = -1;
        return;
    }

    public String pathToString(){
        String path = "No current path!";
        if(current_path[current_index] == -1) {
            return path;
        }
        path = "Current path is: " + Integer.toString(current_path[current_index]);
        for(int i = current_index+1; current_path[i] != -1; i++)
            path += "->" + Integer.toString(current_path[i]);

        return path;
    }

    public int findVertex(int x, int y)
    {
        if(x >= 0 && x < 1000 && y >= 0 && y < 800)
            return 0;
        if(x >= 0 && x < 1000 && y >= 880 && y < 1500)
            return 1;
        if(x >= 0 && x < 1000 && y >= 15 && y < 1900)
            return 2;
        if(x >= 0 && x < 1000 && y >= 1900 && y < 2800)
            return 3;
        if(x >= 0 && x < 400 && y >= 2800 && y < 3100)
            return 4;
        if(x >= 0 && x < 400 && y >= 3100 && y < 3400)
            return 5;
        if(x >= 0 && x < 400 && y >= 3400 && y < 3800)
            return 6;
        if(x >= 0 && x < 400 && y >= 3800 && y < 4400)
            return 7;
        if(x >= 600 && x < 1000 && y >= 3000 && y < 3600)
            return 8;
        if(x >= 1500 && x < 2100 && y >= 1100 && y < 1400)
            return 9;
        if(x >= 1500 && x < 2100 && y >= 1400 && y < 1800)
            return 10;
        if(x >= 1500 && x < 2100 && y >= 1800 && y < 2200)
            return 11;
        if(x >= 1500 && x < 2100 && y >= 2200 && y < 2600)
            return 12;
        if(x >= 1500 && x < 2100 && y >= 2600 && y < 3100)
            return 13;
        if(x >= 1500 && x < 2100 && y >= 3100 && y < 3600)
            return 14;
        if(x >= 2400 && x < 3000 && y >= 200 && y < 500)
            return 15;
        if(x >= 2400 && x < 3000 && y >= 500 && y < 800)
            return 16;
        if(x >= 2400 && x < 3000 && y >= 800 && y < 1100)
            return 17;
        if(x >= 2400 && x < 3000 && y >= 1100 && y < 1400)
            return 18;
        if(x >= 2400 && x < 3000 && y >= 1400 && y < 1800)
            return 19;
        if(x >= 2400 && x < 3000 && y >= 1800 && y < 2200)
            return 20;
        if(x >= 2400 && x < 3000 && y >= 2200 && y < 2500)
            return 21;
        if(x >= 2400 && x < 3000 && y >= 2500 && y < 2800)
            return 22;
        if(x >= 2400 && x < 3000 && y >= 2800 && y < 3200)
            return 23;
        if(x >= 2400 && x < 3000 && y >= 3200 && y < 3600)
            return 24;
        if(x >= 1500 && x < 2100 && y >= 4000 && y < 4400)
            return 25;
        if(x >= 2400 && x < 3000 && y >= 4000 && y < 4400)
            return 26;
        if(x >= 1500 && x < 2100 && y >= 800 && y < 1100)
            return 27;
        if(x >= 1600 && x < 2100 && y >= 500 && y < 800)
            return 28;
        if(x >= 1000 && x < 1400 && y >= 4000 && y < 4400)
            return 29;
        if(x >= 1200 && x < 1500 && y >= 0 && y < 400)
            return 30;
        if(x >= 2400 && x < 3000 && y >= 0 && y < 200)
            return 31;
        if(x >= 0 && x < 1000 && y >= 4400 && y < 4800)
            return 32;
        if(x >= 1000 && x < 1500 && y >= 400 && y < 700)
            return 33;
        if(x >= 1000 && x < 1500 && y >= 3600 && y < 4000)
            return 34;
        if(x >= 2100 && x < 3000 && y >= 3600 && y < 4000)
            return 35;
        if(x >= 2000 && x < 2400 && y >= 200 && y < 500)
            return 36;
        if(x >= 600 && x < 1000 && y >= 2800 && y < 3000)
            return 37;
        if(x >= 600 && x < 1000 && y >= 3600 && y < 3800)
            return 38;
        if(x >= 1500 && x < 2000 && y >= 3600 && y < 4000)
            return 39;
        if(x >= 1600 && x < 2000 && y >= 200 && y < 500)
            return 40;
        if(x >= 0 && x < 3000 && y >= 0 && y < 4400)
            return 41;
        return -1;
    }

    public void navigate(int x, int y){
        current_x = x;
        current_y = y;
        int temp_current_vertex = findVertex(x,y);
        if(current_vertex >40)
            return;
        if(current_destination == -1) {
            current_vertex = temp_current_vertex;
            return;
        }

        if(current_vertex == temp_current_vertex) {
            return;
        }
        current_vertex = temp_current_vertex;
        if(current_path[current_index+1] == current_vertex) {
            if(current_vertex == current_destination) {
                current_index = 0;
                current_destination = -1;
                current_path[0] = -1;
            }
            else {
                current_index += 1;
                current_vertex = temp_current_vertex;
                return;
            }
        }
        else {
            setCurrentPath(current_vertex, current_destination);
            return;
        }
    }

}
